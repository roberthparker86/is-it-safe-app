(this["webpackJsonpis-it-safe-app"]=this["webpackJsonpis-it-safe-app"]||[]).push([[0],{63:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(14),c=r.n(a),s=r(4),i=r(12),o=r(28),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isAuthenticated:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return{isAuthenticated:t.isAuthenticated};case"LOGOUT":return{};default:return e}},l=r(5),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(l.a)({},t.user);case"LOGOUT":return{};case"UPDATE_FOOD":return Object(l.a)(Object(l.a)({},e),{},{freezer:t.freezer,refrigerator:t.refrigerator});default:return e}},f=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.c,p=function(){return Object(i.d)(Object(i.b)({auth:u,user:d}),f(Object(i.a)(o.a)))},m=r(6),j=r(3),b=r.n(j),h=r(7),O=r.n(h),x=r(0),g=function(e){var t=e.id,r=e.type,n=e.onClick,a=e.className,c=e.href,s=e.children;return Object(x.jsx)("button",{id:t,type:r||"",onClick:n||"",className:a,href:c||"",children:s})},v=function(e){return Object(x.jsx)("h1",{className:e.className||"",children:e.children})},N=function(e){var t=Object(s.b)(),r=Object(s.c)((function(e){return e.auth})),a=Object(n.useMemo)((function(){return r.isAuthenticated}),[r]),c=function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://localhost:8080/api/signout",e.next=3,O.a.get("http://localhost:8080/api/signout");case 3:200===e.sent.status&&t({type:"LOGOUT"});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(x.jsx)("header",{children:Object(x.jsxs)("div",{className:"container",children:[Object(x.jsx)(v,{className:"logo",children:"Is It Safe?"}),a&&Object(x.jsxs)(g,{className:"signout__btn",onClick:c,children:[Object(x.jsx)("i",{className:"fas fa-sign-out-alt"}),Object(x.jsx)("h4",{children:"Signout"})]})]})})},y=r(11),_=r(9),D=function(e){var t=e.className,r=e.method,n=e.action,a=e.children;return Object(x.jsx)("form",{className:t||"",method:r||"",action:n||"",children:a})},w=function(e){var t=e.className,r=e.labelText,n=e.id,a=e.inputValue,c=e.placeholder,s=e.onChange;return Object(x.jsxs)("div",{className:t||"",children:[Object(x.jsx)("label",{htmlFor:n||"",children:r}),Object(x.jsx)("input",{type:e.type?e.type:"text",id:n||"",name:n||"",value:a||"",placeholder:c||"",onChange:s})]})},C=function(e){var t=e.remainingTime,r=e.user,n=e.id,a=e.status,c=e.name,s=e.compartment,i=e.handleDelete;return Object(x.jsx)("div",{className:"grid__column",id:n,children:Object(x.jsxs)("div",{className:"grid__card "+a,children:[Object(x.jsx)("h2",{children:t}),Object(x.jsx)("h3",{className:"text-green",children:a}),Object(x.jsx)("h4",{children:c}),Object(x.jsx)("button",{className:"grid__card--close-btn",onClick:function(){return i({userId:r.id,foodId:n,compartment:s})},children:Object(x.jsx)("i",{className:"fas fa-times fa-2x"})})]})},n)},T=function(e){return Object(x.jsxs)("section",{className:"compartment-toggle",children:[Object(x.jsx)("button",{id:"refrigerator",className:"refrigerator"===e.displayedCompartment?"btn btn-primary active":"btn btn-primary",onClick:function(t){t.preventDefault(),e.setDisplayedCompartment(t.target.id)},children:"Refrigerator"}),Object(x.jsx)("button",{id:"freezer",className:"freezer"===e.displayedCompartment?"btn btn-primary active":"btn btn-primary",onClick:function(t){t.preventDefault(),e.setDisplayedCompartment(t.target.id)},children:"Freezer"})]})},k=r(8),z=r.n(k),A=function(e,t){return console.log({start:e,expire:t,toReturn:z()(t).diff(e,"hours")}),z()(t).diff(e,"hour")},E=function(e,t){var r=A(e.startTime,e.expireTime),n=A(t.startTime,t.expireTime);return console.log({aTimeRemain:r,bTimeRemain:n}),r-n>=0?1:-1},F=function(e){var t=Object(s.b)(),r=Object(s.c)((function(e){return e.auth})),a=Object(s.c)((function(e){return e.user})),c=(Object(n.useMemo)((function(){return r.isAuthenticated}),[r]),Object(n.useMemo)((function(){return a}),[a])),i=Object(n.useState)(!1),o=Object(_.a)(i,2),u=o[0],d=o[1],f={foodName:"",startDate:z()().format("YYYY-MM-DD"),expiryDate:"",compartment:""},p=Object(n.useState)(f),j=Object(_.a)(p,2),h=j[0],g=j[1],v=Object(n.useState)(!1),N=Object(_.a)(v,2),k=N[0],F=N[1],S=Object(n.useState)("refrigerator"),I=Object(_.a)(S,2),L=I[0],U=I[1],G=h.foodName,M=h.startDate,R=h.expiryDate,V=h.compartment,P=function(e){var t=e.target,r=t.name,n=t.value;g((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(y.a)({},r,n))}))},Y=function(){var e=Object(m.a)(b.a.mark((function e(r){var n,a,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("http://localhost:8080/api/delete-food",r);case 2:n=e.sent;try{200===n.status&&(console.log(n.data.data),a=n.data.data,c=a.freezer,s=a.refrigerator,c.sort((function(e,t){return E(e,t)})),s.sort((function(e,t){return E(e,t)})),t({type:"UPDATE_FOOD",freezer:c,refrigerator:s}))}catch(i){console.log({err:i})}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=Object(n.useCallback)(function(){var e=Object(m.a)(b.a.mark((function e(r){var n,a,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.put("http://localhost:8080/api/add-food",r);case 2:n=e.sent;try{console.log({response:n}),a=n.data.data,c=a.freezer,s=a.refrigerator,c.sort((function(e,t){return E(e,t)})),s.sort((function(e,t){return E(e,t)})),t({type:"UPDATE_FOOD",freezer:c,refrigerator:s}),F(!1),d(!1),g(f)}catch(i){console.log({err:i}),F(!1),d(!1),g(f)}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[F,t]);return Object(n.useEffect)((function(){if(k){var e={id:c.id,name:G,startTime:z()(M).format(),expireTime:z()(R).format(),compartment:V.toLowerCase()};J(e)}}),[k,h,V,c.id,M,G,R,J]),Object(x.jsxs)("div",{className:"container container--main-content",children:[Object(x.jsx)("button",{id:"add",className:"btn btn-primary",onClick:function(){return d(!u)},children:"+ Add Food"}),Object(x.jsxs)(D,{className:u?"add-food__form show":"add-food__form",children:[Object(x.jsx)(w,{className:"add-food__input-container",labelText:"Food Name",id:"foodName",name:"foodName",inputValue:G,placeholder:"Food name",onChange:P}),Object(x.jsx)(w,{type:"date",className:"add-food__input-container",labelText:"Date Cooked/Opened",id:"startDate",name:"startDate",inputValue:M,placeholder:"Date food was opened or cooked",onChange:P}),Object(x.jsx)(w,{type:"date",className:"add-food__input-container",labelText:"Expiry Date",id:"expiryDate",name:"expiryDate",inputValue:R,placeholder:"Days until food expires",onChange:P}),Object(x.jsx)("label",{htmlFor:"compartment",children:"Refrigerator or freezer?"}),Object(x.jsxs)("select",{name:"compartment",className:"add-food__select",id:"compartment",children:[Object(x.jsx)("option",{value:"refrigerator",children:"Refrigerator"}),Object(x.jsx)("option",{value:"freezer",children:"Freezer"})]}),Object(x.jsx)("button",{type:"submit",className:"btn btn-secondary",onClick:function(e){e.preventDefault(),F(!0)},children:"Add"})]}),Object(x.jsx)(T,{displayedCompartment:L,setDisplayedCompartment:U}),Object(x.jsx)("section",{className:"grid",children:c[L]&&c[L].map((function(e){var t,r=A(e.startTime,e.expireTime),n=(t=r)<=0?"bad":t<48?"warning":"good";return Object(x.jsx)(C,{id:e._id,status:n,remainingTime:r,name:e.name,handleDelete:Y,user:c,compartment:L},e._id)}))})]})},S=function(e){var t=Object(s.b)(),r=Object(n.useState)({email:"",password:""}),a=Object(_.a)(r,2),c=a[0],i=a[1],o=function(e){var t=e.target,r=t.name,n=t.value;i((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(y.a)({},r,n))}))},u=function(){var e=Object(m.a)(b.a.mark((function e(r,n){var a,c,s,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={email:r,password:n},e.prev=1,e.next=4,O.a.post("".concat("http://localhost:8080/api/","signin"),a);case 4:c=e.sent,s=c.data,(i=s.user)&&(i.freezer.sort((function(e,t){return E(e,t)})),i.refrigerator.sort((function(e,t){return E(e,t)})),t({type:"LOGIN",isAuthenticated:!0,user:i})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}();return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"container container--login",children:[Object(x.jsxs)(D,{className:"login-form",children:[Object(x.jsx)(w,{className:"login-form__input",id:"email",inputValue:c.email,onChange:o}),Object(x.jsx)(w,{className:"login-form__input",id:"password",type:"password",inputValue:c.password,onChange:o}),Object(x.jsx)(g,{className:"login-form__btn",onClick:function(e){u(c.email,c.password),e.preventDefault()},children:"Login"})]}),Object(x.jsx)("h4",{children:"or Sign Up"})]})})},I=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.auth})),r=Object(n.useMemo)((function(){return t.isAuthenticated}),[t]),a=function(){var e=Object(m.a)(b.a.mark((function e(){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://localhost:8080/api/",e.next=3,O.a.get("".concat("http://localhost:8080/api/","check-token"));case 3:return t=e.sent,r=t.data,e.abrupt("return",r.success);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){Object(m.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a();case 2:t.sent&&!r&&e({type:"LOGIN",isAuthenticated:!0});case 4:case"end":return t.stop()}}),t)})))()}),[r,e]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(N,{}),r?Object(x.jsx)(F,{}):Object(x.jsx)(S,{})]})},L=p(),U=Object(x.jsx)(s.a,{store:L,children:Object(x.jsx)(I,{})});c.a.render(U,document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.71e420b1.chunk.js.map