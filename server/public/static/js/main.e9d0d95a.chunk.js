(this["webpackJsonpis-it-safe-app"]=this["webpackJsonpis-it-safe-app"]||[]).push([[0],{83:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(24),c=n.n(a),s=n(8),o=n(21),i=n(42),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isAuthenticated:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return{isAuthenticated:t.isAuthenticated};case"LOGOUT":return{};default:return e}},l=n(3),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(l.a)({},t.user);case"LOGOUT":return{};case"UPDATE_FOOD":return Object(l.a)(Object(l.a)({},e),{},{freezer:t.freezer,refrigerator:t.refrigerator});default:return e}},j=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.c,p=function(){return Object(o.d)(Object(o.b)({auth:u,user:d}),j(Object(o.a)(i.a)))},b=n(4),f=n(12),m=n(16),h=n(15),O=n(5),x=n.n(O),g=n(13),v=n.n(g),N=n(1),y=function(e){var t=e.id,n=e.type,r=e.onClick,a=e.className,c=e.href,s=e.children;return Object(N.jsx)("button",{id:t,type:n||"",onClick:r||"",className:a,href:c||"",children:s})},_=function(e){return Object(N.jsx)("h1",{className:e.className||"",children:e.children})},w=function(e){var t=Object(s.c)(),n=Object(b.g)(),a=Object(s.d)((function(e){return e.auth})),c=Object(r.useMemo)((function(){return a.isAuthenticated}),[a]),o=function(){var e=Object(f.a)(x.a.mark((function e(){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://localhost:8080/api/signout",e.next=3,v.a.get("http://localhost:8080/api/signout");case 3:r=e.sent;try{200===r.status&&(t({type:"LOGOUT"}),n.replace("/"),console.log(r))}catch(a){console.log(a)}case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(N.jsx)("header",{children:Object(N.jsxs)("div",{className:"container",children:[Object(N.jsx)(_,{className:"logo",children:"Is It Safe?"}),c&&Object(N.jsxs)(y,{className:"signout__btn",onClick:o,children:[Object(N.jsx)("i",{className:"fas fa-sign-out-alt"}),Object(N.jsx)("h4",{children:"Signout"})]})]})})},D=function(e){var t=e.className,n=e.method,r=e.action,a=e.children;return Object(N.jsx)("form",{className:t||"",method:n||"",action:r||"",children:a})},C=function(e){var t=e.className,n=e.labelText,r=e.id,a=e.inputValue,c=e.placeholder,s=e.onChange;return Object(N.jsxs)("div",{className:t||"",children:[Object(N.jsx)("label",{htmlFor:r||"",children:n}),Object(N.jsx)("input",{type:e.type?e.type:"text",id:r||"",name:r||"",value:a||"",placeholder:c||"",onChange:s})]})},k=function(e){var t=Object(b.g)(),n=Object(r.useState)({firstName:"",email:"",password:""}),a=Object(h.a)(n,2),c=a[0],s=a[1],o=function(e){var t=e.target,n=t.name,r=t.value;s((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(m.a)({},n,r))}))},i=function(){var e=Object(f.a)(x.a.mark((function e(n,r,a){var c,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={firstName:n,email:r.toLowerCase(),password:a},e.prev=1,e.next=4,v.a.post("".concat("http://localhost:8080/api/","signup"),c);case 4:(s=e.sent)&&(console.log(s),t.push("/")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n,r){return e.apply(this,arguments)}}();return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(w,{}),Object(N.jsxs)("div",{className:"container container--login",children:[Object(N.jsx)("h4",{children:"Please enter a valid email address and password to create a user account."}),Object(N.jsxs)(D,{className:"login-form",children:[Object(N.jsx)(C,{className:"login-form__input",id:"firstName",inputValue:c.firstName,onChange:o}),Object(N.jsx)(C,{className:"login-form__input",id:"email",inputValue:c.email,onChange:o}),Object(N.jsx)(C,{className:"login-form__input",id:"password",inputValue:c.password,onChange:o}),Object(N.jsx)(y,{className:"login-form__btn",onClick:function(e){i(c.firstName,c.email,c.password),e.preventDefault()},children:"Sign Up"})]})]})]})},T=n(14),A=n(17),z=n.n(A),E=function(e,t){return console.log({start:e,expire:t,toReturn:z()(t).diff(e,"hours")}),z()(t).diff(e,"hour")},F=function(e,t){var n=E(e.startTime,e.expireTime),r=E(t.startTime,t.expireTime);return console.log({aTimeRemain:n,bTimeRemain:r}),n-r>=0?1:-1},S=function(e){var t=Object(s.c)(),n=Object(b.g)(),a=Object(s.d)((function(e){return e.auth})),c=Object(r.useMemo)((function(){return a.isAuthenticated}),[a]),o=Object(r.useMemo)((function(){return n.location.pathname}),[n]),i=Object(r.useState)({email:"",password:""}),u=Object(h.a)(i,2),d=u[0],j=u[1],p=function(e){var t=e.target,n=t.name,r=t.value;j((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(m.a)({},n,r))}))},O="http://localhost:8080/api/",g=function(){var e=Object(f.a)(x.a.mark((function e(r,a){var c,s,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={email:r,password:a},e.prev=1,e.next=4,v.a.post("".concat(O,"signin"),c);case 4:s=e.sent,(o=s.data)&&(console.log(o),o.user.freezer.sort((function(e,t){return F(e,t)})),o.user.refrigerator.sort((function(e,t){return F(e,t)})),t({type:"LOGIN",isAuthenticated:!0,user:o.user}),n.push("/dashboard")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}();console.log("Updated");var _=function(){var e=Object(f.a)(x.a.mark((function e(){var t,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("".concat(O,"check-token"));case 3:return t=e.sent,n=t.success,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){var e=_();e&&Object(f.a)(x.a.mark((function e(){var r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("".concat(O,"user"));case 2:r=e.sent,(a=r.user)&&(console.log(a),a.freezer.sort((function(e,t){return F(e,t)})),a.refrigerator.sort((function(e,t){return F(e,t)})),t({type:"LOGIN",isAuthenticated:!0,user:a}),n.push("/dashboard"));case 5:case"end":return e.stop()}}),e)})))(),e||Object(f.a)(x.a.mark((function e(){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("".concat(O,"signout"));case 2:r=e.sent,console.log(r.message),t({type:"LOGOUT"}),n.replace("/");case 6:case"end":return e.stop()}}),e)})))()}),[o,t,c,n]),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(w,{}),Object(N.jsxs)("div",{className:"container container--login",children:[Object(N.jsxs)(D,{className:"login-form",children:[Object(N.jsx)(C,{className:"login-form__input",id:"email",inputValue:d.email,onChange:p}),Object(N.jsx)(C,{className:"login-form__input",id:"password",type:"password",inputValue:d.password,onChange:p}),Object(N.jsx)(y,{className:"login-form__btn",onClick:function(e){g(d.email,d.password),e.preventDefault()},children:"Login"})]}),Object(N.jsxs)("h4",{children:["or ",Object(N.jsx)(T.a,{to:"/signup",children:"Sign Up"})]})]})]})},L=function(e){var t=e.remainingTime,n=e.user,r=e.id,a=e.status,c=e.name,s=e.compartment,o=e.handleDelete;return Object(N.jsx)("div",{className:"grid__column",id:r,children:Object(N.jsxs)("div",{className:"grid__card "+a,children:[Object(N.jsx)("h2",{children:t}),Object(N.jsx)("h3",{className:"text-green",children:a}),Object(N.jsx)("h4",{children:c}),Object(N.jsx)("button",{className:"grid__card--close-btn",onClick:function(){return o({userId:n.id,foodId:r,compartment:s})},children:Object(N.jsx)("i",{className:"fas fa-times fa-2x"})})]})},r)},I=function(e){return Object(N.jsxs)("section",{className:"compartment-toggle",children:[Object(N.jsx)("button",{id:"refrigerator",className:"refrigerator"===e.displayedCompartment?"btn btn-primary active":"btn btn-primary",onClick:function(t){t.preventDefault(),e.setDisplayedCompartment(t.target.id)},children:"Refrigerator"}),Object(N.jsx)("button",{id:"freezer",className:"freezer"===e.displayedCompartment?"btn btn-primary active":"btn btn-primary",onClick:function(t){t.preventDefault(),e.setDisplayedCompartment(t.target.id)},children:"Freezer"})]})},U=function(e){var t=Object(b.g)(),n=Object(s.c)(),a=Object(s.d)((function(e){return e.auth})),c=Object(s.d)((function(e){return e.user})),o=Object(r.useMemo)((function(){return a.isAuthenticated}),[a]),i=Object(r.useMemo)((function(){return t.location.pathname}),[t]),u=Object(r.useMemo)((function(){return c}),[c]),d=Object(r.useState)(!1),j=Object(h.a)(d,2),p=j[0],O=j[1],g={foodName:"",startDate:z()().format("YYYY-MM-DD"),expiryDate:"",compartment:""},y=Object(r.useState)(g),_=Object(h.a)(y,2),w=_[0],k=_[1],T=Object(r.useState)(!1),A=Object(h.a)(T,2),S=A[0],U=A[1],V=Object(r.useState)("refrigerator"),G=Object(h.a)(V,2),M=G[0],R=G[1],P=w.foodName,Y=w.startDate,J=w.expiryDate,X=w.compartment,B=function(e){var t=e.target,n=t.name,r=t.value;k((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(m.a)({},n,r))}))},q=function(){var e=Object(f.a)(x.a.mark((function e(t){var r,a,c,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("http://localhost:8080/api/delete-food",t);case 2:r=e.sent;try{200===r.status&&(console.log(r.data.data),a=r.data.data,c=a.freezer,s=a.refrigerator,c.sort((function(e,t){return F(e,t)})),s.sort((function(e,t){return F(e,t)})),n({type:"UPDATE_FOOD",freezer:c,refrigerator:s}))}catch(o){console.log({err:o})}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=Object(r.useCallback)(function(){var e=Object(f.a)(x.a.mark((function e(t){var r,a,c,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.put("http://localhost:8080/api/add-food",t);case 2:r=e.sent;try{console.log({response:r}),a=r.data.data,c=a.freezer,s=a.refrigerator,c.sort((function(e,t){return F(e,t)})),s.sort((function(e,t){return F(e,t)})),n({type:"UPDATE_FOOD",freezer:c,refrigerator:s}),U(!1),O(!1),k(g)}catch(o){console.log({err:o}),U(!1),O(!1),k(g)}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[U,n]);return Object(r.useEffect)((function(){"/"!==i&&!o&&t.replace("/")}),[i,o,t]),Object(r.useEffect)((function(){if(S){var e={id:u.id,name:P,startTime:z()(Y).format(),expireTime:z()(J).format(),compartment:X.toLowerCase()};H(e)}}),[S,w,X,u.id,Y,P,J,H]),Object(N.jsxs)("div",{className:"container container--main-content",children:[Object(N.jsx)("button",{id:"add",className:"btn btn-primary",onClick:function(){return O(!p)},children:"+ Add Food"}),Object(N.jsxs)(D,{className:p?"add-food__form show":"add-food__form",children:[Object(N.jsx)(C,{className:"add-food__input-container",labelText:"Food Name",id:"foodName",name:"foodName",inputValue:P,placeholder:"Food name",onChange:B}),Object(N.jsx)(C,{type:"date",className:"add-food__input-container",labelText:"Date Cooked/Opened",id:"startDate",name:"startDate",inputValue:Y,placeholder:"Date food was opened or cooked",onChange:B}),Object(N.jsx)(C,{type:"date",className:"add-food__input-container",labelText:"Expiry Date",id:"expiryDate",name:"expiryDate",inputValue:J,placeholder:"Days until food expires",onChange:B}),Object(N.jsx)("label",{htmlFor:"compartment",children:"Refrigerator or freezer?"}),Object(N.jsxs)("select",{name:"compartment",className:"add-food__select",id:"compartment",children:[Object(N.jsx)("option",{value:"refrigerator",children:"Refrigerator"}),Object(N.jsx)("option",{value:"freezer",children:"Freezer"})]}),Object(N.jsx)("button",{type:"submit",className:"btn btn-secondary",onClick:function(e){e.preventDefault(),U(!0)},children:"Add"})]}),Object(N.jsx)(I,{displayedCompartment:M,setDisplayedCompartment:R}),Object(N.jsx)("section",{className:"grid",children:u[M]&&u[M].map((function(e){var t,n=E(e.startTime,e.expireTime),r=(t=n)<=0?"bad":t<48?"warning":"good";return Object(N.jsx)(L,{id:e._id,status:r,remainingTime:n,name:e.name,handleDelete:q,user:u,compartment:M},e._id)}))})]})},V=n(27),G=["isAuthenticated","component"],M=Object(s.b)((function(e){return{isAuthenticated:!!e.auth.uid}}))((function(e){var t=e.isAuthenticated,n=e.component,r=Object(V.a)(e,G);return Object(N.jsx)(b.b,Object(l.a)(Object(l.a)({},r),{},{component:function(e){return t?Object(N.jsx)(b.a,{to:"/dashboard"}):Object(N.jsx)(n,Object(l.a)({},e))}}))})),R=["isAuthenticated","component"],P=Object(s.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}))((function(e){var t=e.isAuthenticated,n=e.component,r=Object(V.a)(e,R);return Object(N.jsx)(b.b,Object(l.a)(Object(l.a)({},r),{},{component:function(e){return t?Object(N.jsxs)("div",{children:[Object(N.jsx)(w,{}),Object(N.jsx)(n,Object(l.a)({},e))]}):Object(N.jsx)(b.a,{to:"/"})}}))})),Y=function(){return Object(N.jsxs)("div",{children:["404! Not found. - ",Object(N.jsx)(T.a,{to:"/",children:"Go home"})]})},J=n(44),X=function(e){return Object(N.jsxs)("div",{children:[Object(N.jsx)("h1",{children:"Yo you in the secret sauce meow foo!"}),Object(N.jsx)("p",{children:"(In other woulds auth is working)"})]})},B=Object(J.a)(),q=function(){return Object(N.jsx)(b.c,{history:B,children:Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(b.d,{children:[Object(N.jsx)(M,{path:"/",component:S,exact:!0}),Object(N.jsx)(M,{path:"/signup",component:k,exact:!0}),Object(N.jsx)(P,{path:"/dashboard",component:U,exact:!0}),Object(N.jsx)(P,{path:"/secret",component:X,exact:!0}),Object(N.jsx)(b.b,{component:Y})]})})})},H=p(),K=Object(N.jsx)(s.a,{store:H,children:Object(N.jsx)(q,{})});c.a.render(K,document.getElementById("root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.e9d0d95a.chunk.js.map